expected <- eval(parse(text="c(166666.457290808, NaN, NaN, -166666.875996697, -4.98509922167828, -2.61902478100805, -1.8414424442347, -1.46205392768303, -1.24297128584617, -1.10507311587693, -1.01463477914698, -0.954995209018997, -0.91712367256881, -0.895860307767001, -0.888224874096901, -0.892594094028322, -0.908289442722443, -0.935383922781226, -0.97464605662111, -1.02759241156606, -1.09665388507392, -1.18549435059837, -1.29956963256149, -1.44710739425592, -1.64088613650765, -1.90165656735485, -2.26526279300163, -2.79912390107094, -3.64641834640865, -5.17338086598819, -8.67902810187223, -24.5570606632816, -499999.53853888, NaN, 500000.461434237, 33.8089406197569, 10.5101675094497, 6.42928798769362, 4.75293251135307, 3.85437350644519, 3.30588865243499, 2.94626679106684, 2.7014992646155, 2.53313492432533, 2.41952473198247, 2.34788790703812, 2.31058285808093, 2.30323043166426, 2.32374619660178, 2.37187323937653, 2.44903728684647, 2.5584630138688, 2.70557004644854, 2.8987512180094, 3.15076673292799, 3.48124343240078, 3.92133344788857, 4.52297153300758, 5.37897365327251, 6.67228101036455, 8.81925211162911, 13.0142144684861, 24.6329762708557, 199.584262442977, 999999.577299343, NaN, -1000000.42275699, -33.7989673729834, -15.9017191657562, -10.5705641096319, -8.03387741866095, -6.5676797350653, -5.62575401485408, -4.98092685493399, -4.52211761489347, -4.18889283190103, -3.94588449446144, -3.77138009096501, -3.65173102355736, -3.57842981927706, -3.54653408876102, -3.55384127934159, -3.60054168633523, -3.68924437427395, -3.82538359490815, -4.01812999632787, -4.2821123477166, -4.64061578481113, -5.13174533644612, -5.82114856862652, -6.83100552259598, -8.41591675962139, -11.2066119598002, -17.3067182175995, -40.6025249722487, -1000000.57721665, NaN, 999999.422785324, 99.4325851191483, 21.6877620405098, 11.9965663835353, 8.22151578190044, 6.22027287404986, 4.98535383378275, 4.15048157959277, 3.55053241664054, 3.10014340098713, 2.75075903590255, 2.47273481210032, 2.24695588517223, 2.06054938633597, 1.90453343984496, 1.77245385090551, 1.65955612835819, 1.56226271283873, 1.47783179212889, 1.40412817213507, 1.33946551752406, 1.28249532344245, 1.23212724162091, 1.1874709053741, 1.14779278502644, 1.11248373694846, 1.08103428218244, 1.0530155532891, 1.02806445288299, 1.00587197964411, 0.986173963148254, 0.968743649511638, 0.953385722742933, 0.939931449731558, 0.928234711955401, 0.918168742399761, 0.909623427441131, 0.902503064465506, 0.896724489511134, 0.892215507209484, 0.888913569156225, 0.886764657601501, 0.885722339757637, 0.885746964638824, 0.886804979586069, 0.888868347803466, 0.891914051574425, 0.895923668518844, 0.900883010432083, 0.906781816020575, 0.913613490299644, 0.921374884611161, 0.930066112202787, 0.939690395126781, 0.950253938896425, 0.961765831907388, 0.974237967110128, 0.987684983823992, 1.00212422792727, 1.01757572895081, 1.03406219285453, 1.05160900948363, 1.07024427389027, 1.08999882087168, 1.11090627222132, 1.13300309631935, 1.15632867980445, 1.18092541117409, 1.20683877625609, 1.234117465583, 1.2628134937832, 1.29298233118071, 1.32468304787001, 1.35797847060387, 1.39293535290239, 1.4296245588603, 1.46812126119827, 1.50850515417313, 1.55086068203168, 1.5952772837642, 1.64184965498687, 1.69067802785842, 1.74186847001462, 1.7955332035866, 1.8517909454549, 1.91076726998153, 1.97259499555763, 2.03741459640497, 2.1053746411761, 2.17663226001102, 2.25135364182819, 2.3297145637556, 2.41190095474322, 2.49810949554355, 2.58854825740096, 2.68343738195577, 2.78300980504526, 2.88751202727155, 2.99720493440811, 3.11236467093122, 3.23328357019346, 3.3602711450023, 3.49365514263068, 3.63378266856914, 3.78102138363105, 3.9357607793471, 4.09841353693194, 4.26941697547838, 4.44923459543323, 4.63835772383652, 4.83730726826471, 5.04663558691001, 5.26692848275571, 5.49880733037316, 5.7429313444737, 6)"));
test(id=0, code={
argv <- eval(parse(text="list(c(-3.000001, -3, -3, -2.999999, -2.965, -2.93, -2.895, -2.86, -2.825, -2.79, -2.755, -2.72, -2.685, -2.65, -2.615, -2.58, -2.545, -2.51, -2.475, -2.44, -2.405, -2.37, -2.335, -2.3, -2.265, -2.23, -2.195, -2.16, -2.125, -2.09, -2.055, -2.02, -2.000001, -2, -1.999999, -1.985, -1.95, -1.915, -1.88, -1.845, -1.81, -1.775, -1.74, -1.705, -1.67, -1.635, -1.6, -1.565, -1.53, -1.495, -1.46, -1.425, -1.39, -1.355, -1.32, -1.285, -1.25, -1.215, -1.18, -1.145, -1.11, -1.075, -1.04, -1.005, -1.000001, -1, -0.999999, -0.97, -0.935, -0.9, -0.865, -0.83, -0.795, -0.76, -0.725, -0.69, -0.655, -0.62, -0.585, -0.55, -0.515, -0.48, -0.445, -0.41, -0.375, -0.34, -0.305, -0.27, -0.235, -0.2, -0.165, -0.13, -0.0949999999999998, -0.0599999999999996, -0.0249999999999999, -1e-06, 0, 1e-06, 0.0100000000000002, 0.0450000000000004, 0.0800000000000001, 0.115, 0.15, 0.185, 0.22, 0.255, 0.29, 0.325, 0.36, 0.395, 0.43, 0.465, 0.5, 0.535, 0.57, 0.605, 0.640000000000001, 0.675, 0.71, 0.745000000000001, 0.78, 0.815, 0.850000000000001, 0.885, 0.92, 0.955000000000001, 0.99, 1.025, 1.06, 1.095, 1.13, 1.165, 1.2, 1.235, 1.27, 1.305, 1.34, 1.375, 1.41, 1.445, 1.48, 1.515, 1.55, 1.585, 1.62, 1.655, 1.69, 1.725, 1.76, 1.795, 1.83, 1.865, 1.9, 1.935, 1.97, 2.005, 2.04, 2.075, 2.11, 2.145, 2.18, 2.215, 2.25, 2.285, 2.32, 2.355, 2.39, 2.425, 2.46, 2.495, 2.53, 2.565, 2.6, 2.635, 2.67, 2.705, 2.74, 2.775, 2.81, 2.845, 2.88, 2.915, 2.95, 2.985, 3.02, 3.055, 3.09, 3.125, 3.16, 3.195, 3.23, 3.265, 3.3, 3.335, 3.37, 3.405, 3.44, 3.475, 3.51, 3.545, 3.58, 3.615, 3.65, 3.685, 3.72, 3.755, 3.79, 3.825, 3.86, 3.895, 3.93, 3.965, 4))"));
do.call(`gamma`, argv);
}, o=expected);